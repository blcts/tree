{"ast":null,"code":"var _jsxFileName = \"/Users/lizaz/fed-exam-category-tree-blcts/src/components/Auth/AuthForm.tsx\",\n    _s = $RefreshSig$();\n\nimport classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { createUser, getUserByEmail } from '../../api/users';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthForm = _ref => {\n  _s();\n\n  let {\n    onLogin\n  } = _ref;\n  const [email, setEmail] = useState('');\n  const [name, setName] = useState('');\n  const [needToRegister, setNeedToRegister] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const saveUser = user => {\n    localStorage.setItem('user', JSON.stringify(user));\n    onLogin(user);\n  };\n\n  useEffect(() => {\n    const userData = localStorage.getItem('user');\n\n    if (!userData) {\n      return;\n    }\n\n    try {\n      const user = JSON.parse(userData);\n      onLogin(user);\n    } catch (error) {\n      throw new Error('You need to register');\n    }\n  }, []);\n\n  const loadUser = async () => {\n    const user = await getUserByEmail(email);\n\n    if (user) {\n      saveUser(user);\n    } else {\n      setNeedToRegister(true);\n    }\n  };\n\n  const registerUser = () => {\n    return createUser({\n      name,\n      email\n    }).then(saveUser);\n  };\n\n  const handleSubmit = async event => {\n    event.preventDefault();\n    setErrorMessage('');\n    setLoading(true);\n\n    try {\n      if (needToRegister) {\n        await registerUser();\n      } else {\n        await loadUser();\n      }\n    } catch (error) {\n      setErrorMessage('Something went wrtong');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"box mt-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"title is-3\",\n      children: needToRegister ? 'You need to register' : 'Log in to open todos'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"label\",\n        htmlFor: \"user-email\",\n        children: \"Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classNames('control has-icons-left', {\n          'is-loading': loading\n        }),\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          id: \"user-email\",\n          className: classNames('input', {\n            'is-danger': !needToRegister && errorMessage\n          }),\n          placeholder: \"Enter your email\",\n          disabled: loading || needToRegister,\n          value: email,\n          required: true,\n          onChange: e => setEmail(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"icon is-small is-left\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-envelope\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), !needToRegister && errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"help is-danger\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), needToRegister && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"label\",\n        htmlFor: \"user-name\",\n        children: \"Your Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classNames('control has-icons-left', {\n          'is-loading': loading\n        }),\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"user-name\",\n          className: classNames('input', {\n            'is-danger': needToRegister && errorMessage\n          }),\n          placeholder: \"Enter your name\",\n          required: true,\n          minLength: 4,\n          disabled: loading,\n          value: name,\n          onChange: e => setName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"icon is-small is-left\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-user\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), needToRegister && errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"help is-danger\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: classNames('button is-primary', {\n          'is-loading': loading\n        }),\n        children: needToRegister ? 'Register' : 'Login'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthForm, \"tPIjNbskzau5AM9CD7eknfIxxw4=\");\n\n_c = AuthForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthForm\");","map":{"version":3,"names":["classNames","React","useEffect","useState","createUser","getUserByEmail","AuthForm","onLogin","email","setEmail","name","setName","needToRegister","setNeedToRegister","loading","setLoading","errorMessage","setErrorMessage","saveUser","user","localStorage","setItem","JSON","stringify","userData","getItem","parse","error","Error","loadUser","registerUser","then","handleSubmit","event","preventDefault","e","target","value"],"sources":["/Users/lizaz/fed-exam-category-tree-blcts/src/components/Auth/AuthForm.tsx"],"sourcesContent":["import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { createUser, getUserByEmail } from '../../api/users';\nimport { User } from '../../types/User';\n\nexport type Props = {\n  onLogin: (user: User) => void,\n};\n\nexport const AuthForm: React.FC<Props> = ({ onLogin }) => {\n  const [email, setEmail] = useState('');\n  const [name, setName] = useState('');\n  const [needToRegister, setNeedToRegister] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const saveUser = (user: User) => {\n    localStorage.setItem('user', JSON.stringify(user));\n    onLogin(user);\n  };\n\n  useEffect(() => {\n    const userData = localStorage.getItem('user');\n\n    if (!userData) {\n      return;\n    }\n\n    try {\n      const user = JSON.parse(userData) as User;\n\n      onLogin(user);\n    } catch (error) {\n      throw new Error('You need to register');\n    }\n  }, []);\n\n  const loadUser = async () => {\n    const user = await getUserByEmail(email);\n\n    if (user) {\n      saveUser(user);\n    } else {\n      setNeedToRegister(true);\n    }\n  };\n\n  const registerUser = () => {\n    return createUser({ name, email })\n      .then(saveUser);\n  };\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault();\n\n    setErrorMessage('');\n    setLoading(true);\n\n    try {\n      if (needToRegister) {\n        await registerUser();\n      } else {\n        await loadUser();\n      }\n    } catch (error) {\n      setErrorMessage('Something went wrtong');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"box mt-5\">\n      <h1 className=\"title is-3\">\n        {needToRegister ? 'You need to register' : 'Log in to open todos'}\n      </h1>\n\n      <div className=\"field\">\n        <label className=\"label\" htmlFor=\"user-email\">\n          Email\n        </label>\n\n        <div\n          className={classNames('control has-icons-left', {\n            'is-loading': loading,\n          })}\n        >\n          <input\n            type=\"email\"\n            id=\"user-email\"\n            className={classNames('input', {\n              'is-danger': !needToRegister && errorMessage,\n            })}\n            placeholder=\"Enter your email\"\n            disabled={loading || needToRegister}\n            value={email}\n            required\n            onChange={e => setEmail(e.target.value)}\n          />\n\n          <span className=\"icon is-small is-left\">\n            <i className=\"fas fa-envelope\" />\n          </span>\n        </div>\n\n        {!needToRegister && errorMessage && (\n          <p className=\"help is-danger\">{errorMessage}</p>\n        )}\n      </div>\n\n      {needToRegister && (\n        <div className=\"field\">\n          <label className=\"label\" htmlFor=\"user-name\">\n            Your Name\n          </label>\n\n          <div\n            className={classNames('control has-icons-left', {\n              'is-loading': loading,\n            })}\n          >\n            <input\n              type=\"text\"\n              id=\"user-name\"\n              className={classNames('input', {\n                'is-danger': needToRegister && errorMessage,\n              })}\n              placeholder=\"Enter your name\"\n              required\n              minLength={4}\n              disabled={loading}\n              value={name}\n              onChange={e => setName(e.target.value)}\n            />\n\n            <span className=\"icon is-small is-left\">\n              <i className=\"fas fa-user\" />\n            </span>\n          </div>\n\n          {needToRegister && errorMessage && (\n            <p className=\"help is-danger\">{errorMessage}</p>\n          )}\n        </div>\n      )}\n\n      <div className=\"field\">\n        <button\n          type=\"submit\"\n          className={classNames('button is-primary', {\n            'is-loading': loading,\n          })}\n        >\n          {needToRegister ? 'Register' : 'Login'}\n        </button>\n      </div>\n    </form>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}